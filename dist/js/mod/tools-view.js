define(["lib/jquery","lib/underscore","lib/backbone","mod/grid-model","mod/grid-index-model","mod/grid-controller","mod/tools-keyboard"],function(e,t,n,r,i,s,o){var u=n.View.extend({el:"#tools",events:{"click button.action":"onSelectTask","click .toggle-menu h2":"onToggleMenu","change #grids-list":"onChangeGrid","blur #view-width,#view-height,#grid-name":"onSetAttr"},initialize:function(){var e=this;this.$list=this.$el.find("#grids-list"),this.$width=this.$el.find("#view-width"),this.$height=this.$el.find("#view-height"),this.$name=this.$el.find("#grid-name"),this.update(),i.on("reset add",this.setGridsList,this),r.on("change",this.update,this)},render:function(){},setGridsList:function(){var e="";i.each(function(t){e+='<option value="'+t.id+'">'+t.attributes.name+"</option>"}),this.$list.empty().html(e),this.$list.val(r.id)},onSelectTask:function(e){var t=e.target.className.replace(/action|\s/g,"");switch(t){case"join":s.joinNodes();break;case"split":s.splitNodes();break;case"polygon":s.joinNodes();break;case"delete":s.deleteGeometry()}},onToggleMenu:function(t){var n=e(t.target).closest(".toggle-menu").toggleClass("open");e(".toggle-menu").not(n).removeClass("open")},onChangeGrid:function(){s.loadGrid(parseInt(this.$list.val(),10))},onSetAttr:function(){r.set({width:parseInt(this.$width.val(),10)||"",height:parseInt(this.$height.val(),10)||"",name:this.$name.val()}),this.update()},update:function(){this.$width.val(r.get("width")),this.$height.val(r.get("height")),this.$name.val(r.get("name")),this.$list.find(":selected").text(r.get("name"))}});return new u})