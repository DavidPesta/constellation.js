define(["lib/backbone","lib/underscore","lib/constellation"],function(e,t,n){var r=e.Model.extend(new n.Grid).extend({localStorage:new e.LocalStorage("constellation"),defaults:{id:0,name:"Untitled",icount:0,nodes:null,polys:null,width:"",height:"",background:""},initialize:function(){this.on=e.Events.on,this.off=e.Events.off,this.emit=e.Events.trigger},_id:function(e){return e+this.attributes.icount++},newGrid:function(){this.defaults.id++,this.set(this.defaults,{silent:!0}),this.nodes={},this.polys={},this.trigger("new"),this.saveGrid(),this.update()},loadGrid:function(e){this.set("id",e),this.fetch({success:function(e){e.nodes=e.get("nodes"),e.polys=e.get("polys"),e.update()}})},saveGrid:function(){this.save({nodes:this.nodes,polys:this.polys})},deleteGrid:function(){this.destroy()}});return new r})